import{j as e,bv as z,r as c,a$ as B,b0 as y,b1 as k,b2 as G,B as U,aa as E,a as D,bj as J,bp as ie,a8 as Q,bq as le,bF as ne,bG as oe,ao as ce,bA as O,bB as de,bg as ge,aT as he,A as fe,bi as l,u as me}from"./index-Ba8ks1Kx.js";import{H as K}from"./Header-BI8O4hR5.js";import{F as xe,a as ue,b as L,c as je,g as be}from"./index.esm-CgrdZzsB.js";import{u as R}from"./useStaff-BiEV4BEs.js";import{d as A,a as F}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as X,f as ve,C as pe}from"./useNavigation-B9acw9f2.js";import{k as Se}from"./staffForm-BqX0N4yZ.js";import{u as we,f as V,g as Ce,h as Ne,i as ye,G as Te}from"./SvgIcon-DFF422tH.js";import{A as ke}from"./AdaptableCard-CkQI25-2.js";import"./Views-BfI1Gzhq.js";import{N as Ue}from"./react-number-format.es-BDg91RIn.js";import{M as _e}from"./MediaSkeleton-CKcD8Jl1.js";import"./cloneDeep-DJN0yfLA.js";import"./useThemeClass-Ch7nBv1u.js";const Le="Transfer Panel",Ee="Transfer issue",Re="Basic information for transfer user",Y=({id:i})=>e.jsx("div",{className:"lg:flex items-center justify-between mb-4 gap-3",children:e.jsx("div",{className:"mb-4 lg:mb-0",children:i==="all"?e.jsx(K,{title:Le}):e.jsx(K,{title:Ee,subTitle:Re})})}),Ae=1;je().shape({upload:be().min(Ae,"At least one file uploaded!")});const Fe=i=>{const{id:r}=z(),{transferStaff:n}=R(),{Navigate:t}=X(),[g,h]=c.useState(!1),[x,d]=c.useState([]),[u,j]=c.useState(!0),{getStaffByIdForTemporaly:w}=R();c.useEffect(()=>{(async()=>{if(u){const a=await w(String(r));(a==null?void 0:a.status)!=="success"?E((a==null?void 0:a.status)||F,(a==null?void 0:a.message)||A):d(a.data||[])}j(!1)})()},[r]);const v=()=>{};return e.jsx(e.Fragment,{children:e.jsx(xe,{initialValues:{reason:"",remarks:"",ministry:"",checkboxList:["Attach Document"],upload:[]},validationSchema:Se,onSubmit:async(s,{setSubmitting:a})=>{a(!0);const b={staff_id:String(r),reason:s.reason,remarks:s.remarks,recomanded_ministry:s.ministry},m=await n(b);E((m==null?void 0:m.status)||F,(m==null?void 0:m.message)||A),(m==null?void 0:m.status)==="success"&&t(ve),a(!1)},children:({errors:s,touched:a,values:b,setFieldValue:m,isSubmitting:C})=>e.jsxs(ue,{children:[e.jsxs(B,{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(y,{label:"Enter reason for transfer",invalid:s.reason&&a.reason,errorMessage:s.reason,children:e.jsx(L,{type:"text",name:"reason",placeholder:"Enter reson for transfer",component:k})}),e.jsx(y,{label:"Remarks",invalid:s.remarks&&a.remarks,errorMessage:s.remarks,children:e.jsx(L,{type:"text",name:"remarks",placeholder:"Enter remarks",component:k})}),e.jsx(y,{label:"Recomended ministre for transfer",invalid:s.ministry&&a.ministry,errorMessage:s.ministry,children:e.jsx(L,{type:"text",name:"ministry",placeholder:"Enter Ministry name",component:k})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{asterisk:!0,label:"",invalid:!!s.checkboxList&&!!a.checkboxList,errorMessage:typeof s.checkboxList=="string"?s.checkboxList:void 0,children:e.jsx(G.Group,{value:b.checkboxList,onChange:_=>{m("checkboxList",_)},children:e.jsx(G,{value:"Attach Document",className:"font-bold",children:"Attach Current year staff reports"})})})}),e.jsx(B,{className:"flex justify-end gap-2",children:e.jsx(U,{type:"submit",variant:"solid",onClick:v,loading:C,children:"Issued Transfer"})})]})})})},{Tr:W,Th:ze,Td:De,THead:Ie,TBody:Me}=J,$=[{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:30,label:"30 / page"},{value:40,label:"40 / page"},{value:50,label:"50 / page"}],Pe={active:"bg-emerald-500",blocked:"bg-red-500"},He=({userData:i,filter:r})=>{const n=c.useMemo(()=>[{header:"staff id",accessorKey:"staff_id"},{header:"ippis no",accessorKey:"ippis_no"},{header:"name",accessorKey:"name"},{header:"email",accessorKey:"email"},{header:"Active Status",accessorKey:"is_active",cell:s=>{const a=s.row.original;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:Pe[a.is_active===1?"active":"User archive"]}),e.jsxs("span",{className:"ml-2 rtl:mr-2 capitalize",children:[a.is_freeze==="0"&&"Active",a.is_freeze==="1"&&"User Archive",a.is_freeze==="2"&&"Blocked"]})]})}},{header:"grade level",accessorKey:"grade_level"},{header:"issue transfer",accessorKey:"issue_transfer",cell:s=>{const a=s.row.original;return e.jsxs("div",{children:[a.is_freeze==="0"&&e.jsx(U,{size:"xs",variant:"solid",color:"green-600",onClick:()=>v(a.staff_id),children:"Issued"}),a.is_freeze==="1"&&e.jsx(U,{size:"xs",variant:"twoTone",color:"red-600",children:"Transfered"}),a.is_freeze==="2"&&e.jsx(U,{size:"xs",variant:"twoTone",color:"yellow-600",children:"Wait for conformation"})]})}}],[]),[t,g]=c.useState([]),[h,x]=c.useState(0);c.useEffect(()=>{g(i)},[i]),c.useEffect(()=>{x(t.length)},[t]),c.useEffect(()=>{if(r=="")g(i);else{let s="0";r==="active"?s="0":r==="wait"?s="2":s="1";const a=i.filter(b=>b.is_freeze==s);g(a)}},[r]);const d=we({data:t,columns:n,getCoreRowModel:ye(),getFilteredRowModel:Ne(),getPaginationRowModel:Ce()}),u=s=>{d.setPageIndex(s-1)},j=(s=0)=>{d.setPageSize(Number(s))},{Navigate:w}=X(),v=s=>{w(pe,String(s))};return e.jsxs("div",{children:[e.jsxs(J,{children:[e.jsx(Ie,{children:d.getHeaderGroups().map(s=>e.jsx(W,{children:s.headers.map(a=>e.jsx(ze,{colSpan:a.colSpan,children:V(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(Me,{children:d.getRowModel().rows.map(s=>e.jsx(W,{children:s.getVisibleCells().map(a=>e.jsx(De,{children:V(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(ie,{pageSize:d.getState().pagination.pageSize,currentPage:d.getState().pagination.pageIndex+1,total:h,onChange:u}),e.jsx("div",{style:{minWidth:130},children:e.jsx(Q,{size:"sm",isSearchable:!1,value:$.filter(s=>s.value===d.getState().pagination.pageSize),options:$,onChange:s=>j(s==null?void 0:s.value)})})]})]})},Be=({search:i,onInputChange:r})=>{const n=t=>{r(t.target.value)};return e.jsx(k,{className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(le,{className:"text-lg"}),value:i,onChange:t=>n(t)})},{Control:Ge}=ne,q=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Issued",color:"bg-emerald-500"},{value:"wait",label:"Wait for confirmation",color:"bg-yellow-500"},{value:"blocked",label:"Transfered",color:"bg-red-500"}],Oe=({innerProps:i,label:r,data:n,isSelected:t})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${t?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...i,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{innerClass:n.color}),e.jsx("span",{children:r})]}),t&&e.jsx(oe,{className:"text-emerald-500 text-xl"})]}),Ke=({children:i,...r})=>{const n=r.getValue()[0];return e.jsxs(Ge,{...r,children:[n&&e.jsx(D,{className:"ltr:ml-4 rtl:mr-4",innerClass:n.color}),i]})},Ve=({filter:i,onFilterChange:r})=>{const[n,t]=c.useState("");c.useEffect(()=>{t(i)},[i]);const g=h=>{r((h==null?void 0:h.value)||"")};return e.jsx(Q,{options:q,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Oe,Control:Ke},value:q.filter(h=>h.value===n),onChange:h=>g(h)})},We=({search:i,onSearch:r,filter:n,onFilter:t})=>e.jsx("div",{className:"md:flex items-center justify-between",children:e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(Be,{search:i,onInputChange:r}),e.jsx(Ve,{filter:n,onFilterChange:t})]})}),T=i=>{const{icon:r,avatarClass:n,label:t,value:g,growthRate:h,loading:x,onClickedFunction:d}=i,u=55;return e.jsx(ge,{bordered:!0,onClick:()=>d==null?void 0:d(t||""),className:`${d?"cursor-pointer":"cursor-default"}`,children:e.jsx(he,{loading:x,customLoader:e.jsx(_e,{avatarProps:{className:"rounded",width:u,height:u}}),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(fe,{className:n,size:u,icon:r}),e.jsxs("div",{children:[e.jsx("span",{children:t}),e.jsx("h3",{children:e.jsx(Ue,{thousandSeparator:!0,displayType:"text",value:g})})]})]}),e.jsx(Te,{value:h,suffix:"%"})]})})})},$e=({total:i,active:r,wait:n,blocked:t,onClickedFunction:g})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mb-6",children:[e.jsx(T,{icon:e.jsx(ce,{}),avatarClass:"!bg-indigo-600",label:i.label,value:i.value,growthRate:i.growShrink,loading:!1,onClickedFunction:g}),e.jsx(T,{icon:e.jsx(O,{}),avatarClass:"!bg-indigo-600",label:r.label,value:r.value,growthRate:r.growShrink,loading:!1,onClickedFunction:g}),e.jsx(T,{icon:e.jsx(O,{}),avatarClass:"!bg-indigo-600",label:n.label,value:n.value,growthRate:n.growShrink,loading:!1,onClickedFunction:g}),e.jsx(T,{icon:e.jsx(de,{}),avatarClass:"!bg-emerald-500",label:t.label,value:t.value,growthRate:t.growShrink,loading:!1,onClickedFunction:g})]}),qe=i=>{const{id:r}=z();return e.jsxs(e.Fragment,{children:[e.jsx(Y,{id:String(r)}),r==="all"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mb-6",children:[e.jsx(l,{height:150}),e.jsx(l,{height:150}),e.jsx(l,{height:150}),e.jsx(l,{height:150})]}),e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10}),e.jsx(l,{height:10})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsx(l,{height:10,width:100}),e.jsx(l,{height:10})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(l,{height:10,width:100}),e.jsx(l,{height:10})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsx(l,{height:10,width:100}),e.jsx(l,{height:10})]})]}),e.jsx("div",{className:"flex justify-end gap-2 mt-4",children:e.jsx(l,{height:10,width:300})}),e.jsx("div",{className:"flex justify-end gap-2 mt-4",children:e.jsx(l,{height:50,width:150})})]})]})},cs=i=>{const{id:r}=z(),n=me(o=>o.staff),t=c.useMemo(()=>n.filter(o=>o.type==="user"),[n]),[g,h]=c.useState(!0),[x,d]=c.useState(""),[u,j]=c.useState(""),[w,v]=c.useState([]),[s,a]=c.useState({value:0,growShrink:0,label:"Total Users"}),[b,m]=c.useState({value:0,growShrink:0,label:"Transfer Users"}),[C,_]=c.useState({value:0,growShrink:0,label:"Transfer Users"}),[I,Z]=c.useState({value:0,growShrink:0,label:"Non Transfer Users"}),{getStaff:ee}=R();c.useEffect(()=>{(async()=>{const f=await ee();(f==null?void 0:f.status)!=="success"&&E((f==null?void 0:f.status)||F,(f==null?void 0:f.message)||A),h(!1)})()},[]),c.useEffect(()=>{if(x!==""){const p=t.filter(N=>N.name.toLowerCase().includes(x.toLowerCase())||N.email.toLowerCase().includes(x.toLowerCase())||N.staff_id.toLowerCase().includes(x.toLowerCase())||N.ippis_no.toLowerCase().includes(x.toLowerCase()));v(p)}else v(t);const o=t.length,f=t.filter(p=>p.is_freeze==="0").length,S=f/o*100,P=t.filter(p=>p.is_freeze==="2").length,te=P/o*100,H=t.filter(p=>p.is_freeze==="1").length,re=H/o*100;a({value:o,growShrink:100,label:"All Users"}),m({value:f,growShrink:Number(S.toFixed(2)),label:"Transferable Users"}),_({value:P,growShrink:Number(te.toFixed(2)),label:"Transfered (Wait for Confirmation)"}),Z({value:H,growShrink:Number(re.toFixed(2)),label:"Transfered"})},[t]);const M=o=>{o.length!==0&&j(""),d(o);const f=t.filter(S=>S.name.toLowerCase().includes(o.toLowerCase())||S.email.toLowerCase().includes(o.toLowerCase())||S.staff_id.toLowerCase().includes(o.toLowerCase())||S.ippis_no.toLowerCase().includes(o.toLowerCase()));v(f)},se=o=>{M(""),j(o)},ae=o=>{o===s.label?j(""):o===b.label?j("active"):o===C.label?j("wait"):o===I.label&&j("blocked")};return g?e.jsx(qe,{}):e.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[e.jsx(Y,{id:r||""}),r==="all"?e.jsxs(e.Fragment,{children:[e.jsx($e,{total:s,active:b,wait:C,blocked:I,onClickedFunction:ae}),e.jsxs(ke,{className:"h-full",bodyClass:"h-fulll",children:[e.jsx(We,{search:x,onSearch:M,filter:u,onFilter:se}),e.jsx(He,{userData:w,filter:u})]})]}):e.jsx(Fe,{})]})};export{cs as default};
